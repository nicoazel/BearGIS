<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>BearGIS - Grasshopper GIS Data Exchange Plugin</title>
    <link rel="icon" href="https://github.com/nicoazel/BearGIS/raw/master/docs/img/BearGISIcon_sml.png">
    <meta name="description" content="BearGIS is a Grasshopper plugin for fluid exchange of GIS data. Export and import SHP and GeoJSON files with an interactive map viewer for testing.">
    <link rel="stylesheet" href="css/style.css">

    <!-- Libraries -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="js/ol.js"></script>
    <script src="https://unpkg.com/shpjs@latest/dist/shp.js"></script>

  </head>

  <script>
    // Global variables
    var map;
    var geoJsonDataset;
    var loadedLayers = [];
    var layerCount = 0;

    // Initialize on page load
    var onloadfunctions = function (){
      map = loadmap();
      setupTabs();
    }

    // Tab functionality
    function setupTabs() {
      const tabButtons = document.querySelectorAll('.tab-btn');
      tabButtons.forEach(button => {
        button.addEventListener('click', () => {
          const targetTab = button.dataset.tab;
          
          // Remove active class from all buttons and contents
          document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
          document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
          
          // Add active class to clicked button and corresponding content
          button.classList.add('active');
          document.getElementById(targetTab).classList.add('active');
        });
      });
    }
  </script>

  <body onload="onloadfunctions()">
    <!-- Navigation -->
    <nav class="navbar">
      <div class="navbar-content">
        <h1>
          <img src="https://github.com/nicoazel/BearGIS/raw/master/docs/img/BearGISIcon_sml.png" alt="BearGIS Icon">
          BearGIS
        </h1>
        <ul class="nav-links">
          <li><a href="#components">Components</a></li>
          <li><a href="#map-viewer">Map Viewer</a></li>
          <li><a href="https://github.com/nicoazel/BearGIS" target="_blank">GitHub</a></li>
          <li><a href="https://discourse.mcneel.com/t/beargis-plugin-gis-data-reader-writer-shp-geojson/78602" target="_blank">Forum</a></li>
        </ul>
      </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero">
      <div class="hero-content">
        <h2>BearGIS</h2>
        <p>Grasshopper plugin for seamless GIS data exchange. Import and export SHP and GeoJSON files with full attribute support.</p>
        <div style="display: flex; gap: 0.75rem; justify-content: center; flex-wrap: wrap;">
          <a href="https://github.com/nicoazel/BearGIS/raw/master/docs/plugin-zip/BearGIS_v0.01.6.zip" class="btn" download>Download Plugin</a>
          <a href="https://youtu.be/wtc19CEzHuw" class="btn btn-secondary" target="_blank">Demo</a>
          <a href="https://github.com/nicoazel/BearGIS/raw/master/docs/BearGIS%20Example.zip" class="btn btn-secondary" download>Examples</a>
        </div>
      </div>
    </section>

    <!-- Components Section -->
    <section id="components" class="section">
      <div class="container">
        <div class="section-header">
          <h2>Plugin Components</h2>
          <p>Complete library of components for GIS data exchange in Grasshopper</p>
        </div>

        <!-- Tabs -->
        <div class="tabs">
          <button class="tab-btn active" data-tab="export-tab">Export</button>
          <button class="tab-btn" data-tab="import-tab">Import</button>
          <button class="tab-btn" data-tab="convert-tab">Convert</button>
        </div>

        <!-- Export Tab -->
        <div id="export-tab" class="tab-content active">
          <div class="card-grid">
            <!-- Point to SHP -->
            <div class="card fade-in">
              <img class="card-icon" src="https://github.com/nicoazel/BearGIS/raw/master/docs/img/comp-icon/BearGISIconSet-14.png" alt="Point to SHP">
              <h3>Point to SHP</h3>
              <span class="component-name">ptSHP</span>
              <p>Export Grasshopper points to Shapefile (.shp) format with attributes.</p>
              <span class="card-status status-available">✓ Available</span>
            </div>

            <!-- Multi-Point to SHP -->
            <div class="card fade-in">
              <img class="card-icon" src="https://github.com/nicoazel/BearGIS/raw/master/docs/img/comp-icon/BearGISIconSet-14.png" alt="Multi-Point to SHP">
              <h3>Multi-Point to SHP</h3>
              <span class="component-name">multiPtSHP</span>
              <p>Export multiple Grasshopper points to Shapefile format with attributes.</p>
              <span class="card-status status-available">✓ Available</span>
            </div>

            <!-- Polyline to SHP -->
            <div class="card fade-in">
              <img class="card-icon" src="https://github.com/nicoazel/BearGIS/raw/master/docs/img/comp-icon/BearGISIconSet-15.png" alt="Polyline to SHP">
              <h3>Polyline to SHP</h3>
              <span class="component-name">polylineSHP</span>
              <p>Convert Grasshopper polylines to Shapefile format with attributes.</p>
              <span class="card-status status-available">✓ Available</span>
            </div>

            <!-- Polygon to SHP -->
            <div class="card fade-in">
              <img class="card-icon" src="https://github.com/nicoazel/BearGIS/raw/master/docs/img/comp-icon/BearGISIconSet-16.png" alt="Polygon to SHP">
              <h3>Polygon to SHP</h3>
              <span class="component-name">polygonSHP</span>
              <p>Convert Grasshopper polygons/closed curves to Shapefile format.</p>
              <span class="card-status status-available">✓ Available</span>
            </div>

            <!-- Point to ESRI GeoJSON -->
            <div class="card fade-in">
              <img class="card-icon" src="https://github.com/nicoazel/BearGIS/raw/master/docs/img/comp-icon/BearGISIconSet-14.png" alt="Point to ESRI">
              <h3>Point to ESRI GeoJSON</h3>
              <span class="component-name">esriPt</span>
              <p>Export points to ESRI-formatted GeoJSON with full attribute support.</p>
              <span class="card-status status-available">✓ Available</span>
            </div>

            <!-- Multi-Point to ESRI GeoJSON -->
            <div class="card fade-in">
              <img class="card-icon" src="https://github.com/nicoazel/BearGIS/raw/master/docs/img/comp-icon/BearGISIconSet-14.png" alt="Multi-Point to ESRI">
              <h3>Multi-Point to ESRI</h3>
              <span class="component-name">esriMultiPt</span>
              <p>Export multiple points to ESRI GeoJSON format with attributes.</p>
              <span class="card-status status-available">✓ Available</span>
            </div>

            <!-- Polyline to ESRI GeoJSON -->
            <div class="card fade-in">
              <img class="card-icon" src="https://github.com/nicoazel/BearGIS/raw/master/docs/img/comp-icon/BearGISIconSet-15.png" alt="Polyline to ESRI">
              <h3>Polyline to ESRI GeoJSON</h3>
              <span class="component-name">esriPl</span>
              <p>Convert polylines to ESRI GeoJSON with attributes and projection.</p>
              <span class="card-status status-available">✓ Available</span>
            </div>

            <!-- Polygon to ESRI GeoJSON -->
            <div class="card fade-in">
              <img class="card-icon" src="https://github.com/nicoazel/BearGIS/raw/master/docs/img/comp-icon/BearGISIconSet-16.png" alt="Polygon to ESRI">
              <h3>Polygon to ESRI GeoJSON</h3>
              <span class="component-name">esriPly</span>
              <p>Export polygons to ESRI GeoJSON format with attributes.</p>
              <span class="card-status status-available">✓ Available</span>
            </div>

            <!-- Point to GeoJSON -->
            <div class="card fade-in">
              <img class="card-icon" src="https://github.com/nicoazel/BearGIS/raw/master/docs/img/comp-icon/BearGISIconSet-14.png" alt="Point to GeoJSON">
              <h3>Point to GeoJSON</h3>
              <span class="component-name">geoJsonPt</span>
              <p>Export points to standard GeoJSON format with attributes.</p>
              <span class="card-status status-available">✓ Available</span>
            </div>

            <!-- Multi-Point to GeoJSON -->
            <div class="card fade-in">
              <img class="card-icon" src="https://github.com/nicoazel/BearGIS/raw/master/docs/img/comp-icon/BearGISIconSet-14.png" alt="Multi-Point to GeoJSON">
              <h3>Multi-Point to GeoJSON</h3>
              <span class="component-name">geoJsonMultiPt</span>
              <p>Export multiple points to standard GeoJSON format.</p>
              <span class="card-status status-available">✓ Available</span>
            </div>

            <!-- Polyline to GeoJSON -->
            <div class="card fade-in">
              <img class="card-icon" src="https://github.com/nicoazel/BearGIS/raw/master/docs/img/comp-icon/BearGISIconSet-15.png" alt="Polyline to GeoJSON">
              <h3>Polyline to GeoJSON</h3>
              <span class="component-name">geoJsonPl</span>
              <p>Convert polylines to standard GeoJSON format.</p>
              <span class="card-status status-available">✓ Available</span>
            </div>

            <!-- Polygon to GeoJSON -->
            <div class="card fade-in">
              <img class="card-icon" src="https://github.com/nicoazel/BearGIS/raw/master/docs/img/comp-icon/BearGISIconSet-16.png" alt="Polygon to GeoJSON">
              <h3>Polygon to GeoJSON</h3>
              <span class="component-name">geoJsonPly</span>
              <p>Export polygons to standard GeoJSON format.</p>
              <span class="card-status status-available">✓ Available</span>
            </div>
          </div>
        </div>

        <!-- Import Tab -->
        <div id="import-tab" class="tab-content">
          <div class="card-grid">
            <!-- Read SHP -->
            <div class="card fade-in">
              <img class="card-icon" src="https://github.com/nicoazel/BearGIS/raw/master/docs/img/comp-icon/BearGISIconSet-20.png" alt="Read SHP">
              <h3>Read SHP</h3>
              <span class="component-name">rShp</span>
              <p>Import Shapefile (.shp) into Grasshopper with geometry and attributes. Multi-part geometries are handled with sub-branches.</p>
              <span class="card-status status-available">✓ Available</span>
            </div>

            <!-- Import ESRI GeoJSON -->
            <div class="card fade-in">
              <img class="card-icon" src="https://github.com/nicoazel/BearGIS/raw/master/docs/img/comp-icon/BearGISIconSet-18.png" alt="Import ESRI GeoJSON">
              <h3>Import ESRI GeoJSON</h3>
              <span class="component-name">impEsri</span>
              <p>Import ESRI-formatted GeoJSON files with fields and attributes. Supports multi-part geometry with sub-branches.</p>
              <span class="card-status status-available">✓ Available</span>
            </div>

            <!-- Import GeoJSON -->
            <div class="card fade-in">
              <img class="card-icon" src="https://github.com/nicoazel/BearGIS/raw/master/docs/img/comp-icon/BearGISIconSet-18.png" alt="Import GeoJSON">
              <h3>Import GeoJSON</h3>
              <span class="component-name">impGeoJson</span>
              <p>Import standard GeoJSON files with all fields and attributes. Multi-part geometry supported.</p>
              <span class="card-status status-available">✓ Available</span>
            </div>
          </div>
        </div>

        <!-- Convert Tab -->
        <div id="convert-tab" class="tab-content">
          <div class="card-grid">
            <!-- Lat Long to Point -->
            <div class="card fade-in">
              <img class="card-icon" src="https://github.com/nicoazel/BearGIS/raw/master/docs/img/comp-icon/BearGISIconSet-17.png" alt="Lat Long to Point">
              <h3>Lat Long to Point</h3>
              <span class="component-name">ptLoc</span>
              <p>Convert latitude/longitude coordinates to Grasshopper points using ESRI .prj files. All coordinates are in WGS84 (EPSG:4326).</p>
              <span class="card-status status-available">✓ Available</span>
            </div>

            <!-- Point to Lat Lon -->
            <div class="card fade-in">
              <img class="card-icon" src="https://github.com/nicoazel/BearGIS/raw/master/docs/img/comp-icon/BearGISIconSet-17.png" alt="Point to Lat Lon">
              <h3>Point to Lat Lon</h3>
              <span class="component-name">ptLatLon</span>
              <p>Convert Grasshopper points to latitude/longitude based on .prj file projection. Outputs in WGS84.</p>
              <span class="card-status status-available">✓ Available</span>
            </div>

            <!-- Reproject -->
            <div class="card fade-in">
              <img class="card-icon" src="https://github.com/nicoazel/BearGIS/raw/master/docs/img/comp-icon/BearGISIconSet-17.png" alt="Reproject">
              <h3>Reproject</h3>
              <span class="component-name">reproject</span>
              <p>Transform points between different projection systems using ESRI .prj files.</p>
              <span class="card-status status-available">✓ Available</span>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Map Viewer Section -->
    <section id="map-viewer" class="section">
      <div class="container">
        <div class="map-section">
          <div class="section-header">
            <h2>Map Viewer</h2>
            <p>Test your BearGIS exports: drag and drop GeoJSON or Shapefile (.shp + .dbf + .shx) files</p>
          </div>

          <div class="map-container">
            <!-- Controls Sidebar -->
            <div class="map-controls">
              <h3>Upload Files</h3>
              
              <div class="upload-area" id="file-drop-div">
                <div class="upload-icon">📁</div>
                <p><strong>Drag & Drop files here</strong></p>
                <p class="file-types">Supports: .geojson, .shp (with .dbf, .shx), .zip</p>
              </div>

              <div id="file-list-container" style="display: none;">
                <h4>Loaded Files</h4>
                <div class="file-list" id="file-drop-list"></div>
              </div>

              <button class="btn" onclick="clearAllLayers()" style="width: 100%; margin-top: 1rem;">Clear All Layers</button>

              <div class="map-legend">
                <h4>Legend</h4>
                <div class="legend-item">
                  <div class="legend-symbol point"></div>
                  <span>Points</span>
                </div>
                <div class="legend-item">
                  <div class="legend-symbol line"></div>
                  <span>Lines/Polylines</span>
                </div>
                <div class="legend-item">
                  <div class="legend-symbol polygon"></div>
                  <span>Polygons</span>
                </div>
              </div>
            </div>

            <!-- Map -->
            <div>
              <div id="map-div-id"></div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
      <div class="footer-content">
        <h3>BearGIS</h3>
        <p>Open source GIS plugin for Grasshopper</p>
        <div class="footer-links">
          <a href="https://github.com/nicoazel/BearGIS" target="_blank">GitHub</a>
          <a href="https://discourse.mcneel.com/t/beargis-plugin-gis-data-reader-writer-shp-geojson/78602" target="_blank">Forum</a>
          <a href="https://youtu.be/wtc19CEzHuw" target="_blank">Video</a>
          <a href="https://github.com/nicoazel/BearGIS/raw/master/docs/BearGIS%20Example.zip" download>Examples</a>
        </div>
        <p style="margin-top: 1rem; opacity: 0.7; font-size: 0.85rem;">&copy; 2025 BearGIS</p>
      </div>
    </footer>

    <!-- Scripts -->
    <script src='js/loadOpenLayersMap.js'></script>
    <script src='js/fileHandler.js'></script>

  </body>
</html>
